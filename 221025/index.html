<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="js/jquery.min.js"></script>
    <script src="js/echarts.min.js"></script>
    <script src="js/china.js"></script>
</head>
<body>
    <div style="float: left;margin: 0px 10px;">
        <input type="text" id="inp" value="黑龙江" placeholder="输入">
        <button id="btn">搜索</button>
    </div>
    <div id="main"></div>
    <script>
        document.getElementById("main").style.height = document.documentElement.clientHeight + 'px'
        let token = 'jPZsMD7Nw9XZpBRASG6cF6HXHYPKUXCg';
        let url = 'http://api.map.baidu.com/geocoder/v2/?output=json&ak=' + token + '&address=';
        let inp = $("#inp");
        let btn = $("#btn");
        let chartData = [];

        let myChart = echarts.init(document.getElementById("main"))
        btn.click(function(){
        	var place = inp.val();
        	if(place){
        	    $.getJSON(url + place + '&callback=?',function(res){
        	    	if(res.status === 0){
        	    		console.log(res);
        	    		loc = res.result.location;
        	    		chartData.push({
        	    			name:inp.val(),
        	    			value:[loc.lng,loc.lat]
        	    		});
        	    		drawMap(place);
        	    	}else{
        	    		alert('百度没有找到地址信息');
        	    	}
        	    });
        	}
        });
        function drawMap(name){
        	var option = {
        		backgroundColor:'#39c',
        		title:{
        			text:'我要去的地方',
        			left:'center',
        			textStyle:{
        				color:'#fff'
        			},
        		},
        		tooltip:{
        			trigger:'item'
        		},
        		toolbox:{
        			show:true,
        			feature:{
        				saveAsImage:{
        					show:true
        				}
        			}
        		},
            	geo:{
            		map:'china',
            		roam:true,
            		label:{
            			emphasis:{
            				show:false
            			}
            		},
            	},
                series: [
                    {
                    	name:'地址',
                        type: 'scatter',
                        coordinateSystem:'geo',
                        data:chartData,
                        label:{
                        	normal:{
                        		show:true,
                        		offset:[0,10],
                        		formatter:'{b}',
                        		textStyle:{
                        			color:'#333',
                        			fontSize:14,
                        			fontWeight:'bold'
                        		}
                        	}
                        },
                        symbolSize:function(val){
                        	return 10;
                        }
                    }
                ]
            };
        	myChart.setOption(option);
        	console.log(option.series);
        }
        //页面接在完成后执行
        $(function(){
        	//点击btn按钮
        	btn.trigger('click');
        });
    </script>
</body>
</html>
